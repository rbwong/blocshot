{% load static %}
{% load staticfiles %}

<!DOCTYPE html>
<html>
  <head>
    <title>Engineering Survival Guide</title>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- css -->
    <link href="{% static "css/bootstrap.min.css" %}" rel="stylesheet" media="screen">
    <link href="{% static "css/style.css" %}" rel="stylesheet" media="screen">
    <link href="{% static "color/default.css" %}" rel="stylesheet" media="screen">
    <script src="{% static "js/modernizr.custom.js" %}"></script>
    <script src="{% static "js/jquery.js" %}"></script>
  </head>
  <body>
      <script src="http://connect.facebook.net/en_US/all.js"></script>
      <script>
        FB.init({
          appId  : '632923070139972',
          status : true, 
          cookie : true, 
          xfbml  : true  
        });
      </script>
      <script type="text/javascript">
      $(document).ready(function(){
          FB.getLoginStatus(function(response) {
              if (response.status == 'connected') {
                  var user_id = response.authResponse.userID;
                  var page_id = "319460261534495";
                  var fql_query = "SELECT uid FROM page_fan WHERE page_id =" + page_id + " and uid=" + user_id;
                  var the_query = FB.Data.query(fql_query);

                  the_query.wait(function(rows) {

                      if (rows.length == 1 && rows[0].uid == user_id) {
                         document.getElementById("like-wrong").style.display = 'none';
                         document.getElementById("like-ok").style.display = 'block';
                      } else {
                         document.getElementById("like-wrong").style.display = 'block';
                        document.getElementById("like-ok").style.display = 'none';
                      }
                  });
              } else {
                  // user is not logged in
              }
          });

      });
      </script>

      <!-- like buttons -->
      <div class="fb-like-box" data-href="https://www.facebook.com/upepsilonchi" data-width="300" data-height="100" data-colorscheme="light" data-show-faces="true" data-header="true" data-stream="false" data-show-border="true"></div>

      <!-- gate handler -->
      <div id="like-wrong">
          Please like page to continue!
      </div>
      <div id="like-ok" style="display:none">
          <!-- About -->
          <section id="about" class="home-section bg-white">
            <div class="container">
                  <div class="row">
                      <div class="col-md-offset-2 col-md-8">
                        <div class="section-heading">
                         <h2>Engineering Survival Guide</h2>
                         <p></p>
                         {% if messages %}
                            <ul class="messages">
                                {% for message in messages %}
                                    <div class="alert alert-success" role="alert">{{ message }}</div>
                                {% endfor %}
                            </ul>
                        {% endif %}
                        </div>
                      </div>
                  </div>
                  <div class="row">
                    <img src="{% static "img/cover.jpg" %}"></img>
              </div>
          </section>

         <!-- Contact -->
          <section id="contact" class="home-section bg-white">
            <div class="container">
                  <div class="row">
                      <div class="col-md-offset-2 col-md-8">
                        <div class="section-heading">
                         <h2>Grab a copy now!</h2>
                         <p>Contact via form below and we will be get in touch with you.</p>
                        </div>
                      </div>
                  </div>

                <div class="row">
                    <div class="col-md-offset-1 col-md-10">
                    <form action="/" method="post" class="form-horizontal" role="form">
                      {% csrf_token %}
                      <div class="form-group">
                        <div class="col-md-offset-2 col-md-8">
                          <input type="text" class="form-control" id="inputName" placeholder="Name" name="name">
                          {% if form.name.errors %}
                                <div class="alert alert-danger" role="alert">{{ form.name.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="form-group">
                        <div class="col-md-offset-2 col-md-8">
                          <input type="text" class="form-control" id="inputEmail" placeholder="Phone no." name="phone_no">
                          {% if form.phone_no.errors %}
                                <div class="alert alert-danger" role="alert">{{ form.phone_no.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="form-group">
                        <div class="col-md-offset-2 col-md-8">
                          <input type="text" class="form-control" id="inputSubject" placeholder="Bloc: ex. G-22" name="bloc">
                          {% if form.bloc.errors %}
                                <div class="alert alert-danger" role="alert">{{ form.bloc.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="form-group">
                        <div class="col-md-offset-2 col-md-8">
                          <input type="text" class="form-control" id="inputSubject" placeholder="facebook url: ex. www.facebook.com/juandelacruz" name="facebook">
                          {% if form.facebook.errors %}
                                <div class="alert alert-danger" role="alert">{{ form.facebook.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="form-group">
                        <div class="col-md-offset-2 col-md-8">
                         <button type="submit" class="btn btn-theme btn-lg btn-block">Submit Form</button>
                        </div>
                      </div>
                    </form>

                    </div>
                </div>
            </div>
          </section>

        <!-- spacer 2 -->
        <section id="spacer" class="home-section spacer">
           <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="color-light">
                        <h2 class="wow bounceInDown" data-wow-delay="1s">Brought to you by</h2>
                        <img src="{% static "img/seal.png" %}" style="width: 250px; height: auto;"></img>
                        </div>
                    </div>
                </div>
            </div>
        </section>
      </div>

     <!-- js -->
    <script src="{% static "js/jquery.js" %}"></script>
    <script src="{% static "js/bootstrap.min.js" %}"></script>
    <script src="{% static "js/jquery.smooth-scroll.min.js" %}"></script>
    <script src="{% static "js/jquery.dlmenu.js" %}"></script>
    <script src="{% static "js/wow.min.js" %}"></script>
    <script src="{% static "js/custom.js" %}"></script>
    <script type="text/javascript">
      $(document).ready(function(){

        FB.login(function(response) {
          if (response.session) {

              var user_id = response.session.uid;
              var page_id = "632923070139972"; //coca cola
              var fql_query = "SELECT uid FROM page_fan WHERE page_id = "+page_id+"and uid="+user_id;
              var the_query = FB.Data.query(fql_query);

              the_query.wait(function(rows) {

                  if (rows.length == 1 && rows[0].uid == user_id) {
                      alert('yeah!');
                      //here you could also do some ajax and get the content for a "liker" instead of simply showing a hidden div in the page.

                  } else {
                      alert('boo!');
                      //and here you could get the content for a non liker in ajax...
                  }
              });


          } else {
            // user is not logged in
          }
        });

    });
    </script>

</html>
